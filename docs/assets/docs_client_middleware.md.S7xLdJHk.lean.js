import{_ as l,c as n,J as e,w as t,a4 as h,E as k,o as d,m as i,a as s}from"./chunks/framework.B_Y9JRDA.js";const O=JSON.parse('{"title":"Middleware","description":"","frontmatter":{"title":"Middleware"},"headers":[],"relativePath":"docs/client/middleware.md","filePath":"docs/client/middleware.md"}'),r={name:"docs/client/middleware.md"},p=i("h1",{id:"middleware",tabindex:"-1"},[s("Middleware "),i("a",{class:"header-anchor",href:"#middleware","aria-label":'Permalink to "Middleware"'},"​")],-1),o=i("h1",{id:"middleware-1",tabindex:"-1"},[s("Middleware "),i("a",{class:"header-anchor",href:"#middleware-1","aria-label":'Permalink to "Middleware"'},"​")],-1),E=i("p",null,"在客户端当中，也有类似 Milkio 一样的中间件，可以在客户端向 Milkio 所发送的请求之前或之后执行任意逻辑。",-1),c=i("p",null,"In the client-side, there are also middleware similar to Milkio that can execute arbitrary logic before or after sending requests to Milkio.",-1),g=i("p",null,[s("例如，我们的登录功能，通常会使用 "),i("a",{href:"https://jwt.io/introduction",target:"_blank",rel:"noreferrer"},"JWT"),s(" 这样的方案来实现，这就需要我们在每个请求的 header 中，都添加证明用户身份的 token，而且我们的 token 可能还会根据时间而变化。客户端的中间件可以帮助我们将类似这样的功能封装起来，自动在每个请求中都添加合适的 token。当然，这只是在客户端中使用中间件，最常见的用法。")],-1),y=i("p",null,[s("For example, our login feature usually implements solutions like "),i("a",{href:"https://www.oauth.com/oauth2-servers/background/",target:"_blank",rel:"noreferrer"},"OAuth"),s(" or "),i("a",{href:"https://jwt.io/introduction",target:"_blank",rel:"noreferrer"},"JWT"),s(", which require us to add a token in the header of each request to authenticate the user's identity. Additionally, our token may change over time. Client-side middleware can help us encapsulate such functionality, automatically adding the appropriate token to each request. Of course, this is just the most common usage of middleware in the client-side.")],-1),F=i("h2",{id:"使用",tabindex:"-1"},[s("使用 "),i("a",{class:"header-anchor",href:"#使用","aria-label":'Permalink to "使用"'},"​")],-1),u=i("h2",{id:"usage",tabindex:"-1"},[s("Usage "),i("a",{class:"header-anchor",href:"#usage","aria-label":'Permalink to "Usage"'},"​")],-1),f=i("p",null,[s("打开你的 "),i("code",null,"/src/packages/client/index.ts"),s("，像下面这样，就可以编写中间件了。你会发现它的写法几乎和 Milkio 的中间件写法几乎一样。")],-1),m=i("p",null,[s("Open your "),i("code",null,"/src/packages/client/index.ts"),s(" file, and you can write middleware like this. You will find that its syntax is almost the same as Milkio's middleware syntax.")],-1),A=h("",1),_=i("p",null,[s("由于你的客户端所运行的环境是不确定的（尽管绝大部分情况下，它都运行在浏览器中），因此，请使用方法参数中的 "),i("code",null,"storage"),s(" 来存储诸如 token 之类的数据，它的用法和 "),i("code",null,"localStorage"),s(" 一样，唯一的区别是它的返回值都是 Promise，因此，你需要在它们前面添加 "),i("code",null,"await"),s("。")],-1),w=i("p",null,[s("Due to the uncertainty of the environment in which your client is running (although in most cases, it runs in a browser), please use the "),i("code",null,"storage"),s(" parameter in the method to store data such as tokens. Its usage is the same as "),i("code",null,"localStorage"),s(", with the only difference being that its return values are Promises. Therefore, you need to prepend "),i("code",null,"await"),s(" before them.")],-1),C=i("h2",{id:"在客户端中添加中间件",tabindex:"-1"},[s("在客户端中添加中间件 "),i("a",{class:"header-anchor",href:"#在客户端中添加中间件","aria-label":'Permalink to "在客户端中添加中间件"'},"​")],-1),D=i("h2",{id:"adding-middleware-in-the-client",tabindex:"-1"},[s("Adding Middleware in the Client "),i("a",{class:"header-anchor",href:"#adding-middleware-in-the-client","aria-label":'Permalink to "Adding Middleware in the Client"'},"​")],-1),b=i("p",null,[s("除了在你的 Milkio 工程中，直接向客户端提供内置的中间件之外，你也可以在你的 web 工程中添加中间件。在你 web 工程的 "),i("code",null,"client.ts"),s(" 中，像这样也可以添加中间件：")],-1),B=i("p",null,[s("In addition to providing built-in middleware directly to the client in your Milkio project, you can also add middleware to your web project. In your web project's "),i("code",null,"client.ts"),s(", you can add middleware like this:")],-1),x=i("div",{class:"language-ts vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"ts"),i("pre",{class:"shiki shiki-themes github-light github-dark has-diff vp-code"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"export"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," const"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," client"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," createClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"({")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  baseUrl: "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'http://localhost:9000/'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  storage: localStorage,")]),s(`
`),i("span",{class:"line diff add"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  middlewares"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": () "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," [ middlewareA ], ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"  async"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," handler"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"url"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"body"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"headers"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," await"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"await"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," fetch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(url, { body, headers }))."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"text"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"})")])])])],-1),v=i("div",{class:"language-ts vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"ts"),i("pre",{class:"shiki shiki-themes github-light github-dark has-diff vp-code"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"export"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," const"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," client"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," createClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"({")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  baseUrl: "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'http://localhost:9000/'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  storage: localStorage,")]),s(`
`),i("span",{class:"line diff add"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  middlewares"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": () "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," [ middlewareA ], ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"  async"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," handler"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"url"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"body"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"headers"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," await"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"await"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," fetch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(url, { body, headers }))."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"text"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"})")])])])],-1);function M(q,P,S,T,j,I){const a=k("I18N");return d(),n("div",null,[e(a,null,{default:t(()=>[p,o,E,c,g,y,F,u,f,m]),_:1}),A,e(a,null,{default:t(()=>[_,w,C,D,b,B,x,v]),_:1})])}const V=l(r,[["render",M]]);export{O as __pageData,V as default};
